## 防止重复消费（幂等问题）



**幂等性**

​	是指可以使用相同参数重复执行，并能获得相同结果的函数。这些函数不会影响系统状态，也不用担心重复执行会对系统造成改变

**出现重复消费的场景**

​	消费者采用事务的方式进行消息的消费，但是没有采用session.commit()。

**防止出现重复消费有以下几种方法**

​	给消息消息建议唯一ID，并插入数据库。在消费之前，先查找数据库，如果存在就不消费，根据情况是更新消息还是丢弃消息；反之则消费同理，也可以采用redis来进行处理，因为redis每次操作都是set，天然的幂等性 （推荐）可在内存中维护一个set，只要从消息队列里面获取到一个消息，先查询这个消息在不在set里面，如果在表示已消费过，直接丢弃；如果不在，则在消费后将其加入set当中